{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TodoList</title>
    <link rel="stylesheet" href="{% static 'todo/style.css' %}">
    <link rel="icon" href="{% static 'todo/logo.png' %}">
    <link rel="preconnect" href="https://fonts.googleapis.com"> 
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin> 
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap" rel="stylesheet">
</head>    
<body>

<nav>
    <ul>
        <li>
            <a href="{% url 'home' %}" id="Logo">
                <img src={% static 'todo/logo.png' %} width="40" height="40" alt="Logo">
                <span>TodoList</span>
            </a>
        </li>
        {% if user.is_authenticated %}
            <li>
                <a href="{% url 'currenttodos' %}">Current</a>
            </li>
            <li>
                <a href="{% url 'completedtodos' %}">Completed</a>
            </li>
        {% endif %}
        {% if user.is_authenticated %}
            <li>
                <form method="POST" action="{% url 'logoutuser' %}">
                    {% csrf_token %}
                    <button type="submit">Log Out</button>
                </form>
            </li>
        {% else %}
            
            <li>
                <a href="{% url 'signupuser' %}">Sign Up</a><a href="{% url 'loginuser' %}">Login</a>
            </li>

            
            
        {% endif %}
    </ul>
</nav>

{% block content %} {% endblock %}
</br>


<script>

    function getCookie(name) {
        let cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            const cookies = document.cookie.split(';');
            for (let i = 0; i < cookies.length; i++) {
                const cookie = cookies[i].trim();

                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }

    const csrftoken = getCookie('csrftoken');
    function check(obj, id) {
        if(obj.getAttribute('src') === "{% static 'todo/circle.png' %}") {
            obj.src = "{% static 'todo/logo.png' %}";
            obj.parentElement.classList.toggle('hide')
            setTimeout(function (){
  
                fetch(`{{ '../todo/${id}/complete' }}`, {method: 'POST', headers: { "X-CSRFToken": csrftoken }})
                .then(response => response)
                location.reload();
                return false;
                          
              }, 500);
            
        }
    }
</script>
</body>
</html>